<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta id="myViewport" name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Circle Permissions and Settings | Care Circles</title>
    <link rel="stylesheet" href="assets/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/assets/css/permissions.css">
    <link rel="stylesheet" href="/assets/css/style.css">

    <!-- Favicon -->
    <link rel="icon" href="/favicon.png?v=4">
    <meta name="theme-color" content="#ffffff">
  </head>
  <body>
    <header>
      <!-- Navigation -->
      <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#mobilemenu">
              <span class="sr-only">Toggle navigation</span>
            </button>
            <a class="navbar-brand" href="/"><img alt="logo" src="assets/img/logo2-navbar.png"></a>
          </div>
          <!-- Collect the nav links, forms, and other content for toggling -->
          <div class="collapse navbar-collapse">
            <ul class="nav navbar-nav navbar-right">
              <li><a href="circles">My Circles</a></li>
              <li><a href="permissions">Permissions</a></li>
              <li><a href="">Help</a></li>
            </ul>
          </div>
          <div id="mobilemenu">
            <ul class="nav navbar-nav">
              <li><a href="circles">My Circles</a></li>
              <li><a href="permissions">Permissions</a></li>
              <li><a href="">Help</a></li>
            </ul>
          </div>
        </div>
      </nav>
    </header>
    <div class="container mt100">
      <h1>Welcome to CareCircles, Edna</h1>
      <div class="panel panel-default">
        <!-- Default panel contents -->
        <div class="panel-body">
          <p class="explanation">
            This is your settings page, use it to confirm of modify the permissions you want to grant to each circle. You can come back later to change this at any time
          </p>
        </div>

        <!-- Table -->
        <table class="table permissions-table" id="permissions-table">
          <tr>
            <th class="special"><img src="/assets/img/whitespace.png" class="row-icon">
              <p class="header-label">Permissions</p>
            </th>
            <th>
              <img src="/assets/img/InnerCircleBigger.png" class="header-icon">
              <p class="header-label">Inner</p>
              <p>Personal, sensitive, and trusted</p>
            </th>
            <th>
              <img src="/assets/img/OuterCircleBigger.png" class="header-icon">
              <p class="header-label">Outer</p>
              <p>Diet, nutrition, and lifestyle</p>
            </th>
            <th>
              <img src="/assets/img/ExtendedCircle.png" class="header-icon">
              <p class="header-label">Extended</p>
              <p>Support and community engagement</p>
            </th>
          </tr>

          <tr>
            <td>
              <div class="row-icon-block">
                <img src="/assets/img/medication.png" class="row-icon">
              </div>
              <div class="row-name-block">
                <p class="row-name">Medication</p>
              </div>
            </td>
            <td>
              <button class="permission-checkbox inner checked default" id="medication-inner"></button>
            </td>
            <td>
              <button class="permission-checkbox outer" id="medication-outer"></button>
            </td>
            <td>
              <button class="permission-checkbox extended" id="medication-extended"></button>
            </td>
          </tr>
          <tr>
            <td>
              <div class="row-icon-block">
                <img src="/assets/img/diagnosis.png" class="row-icon">
              </div>
              <div class="row-name-block">
                <p class="row-name">Diagnosis</p>
              </div>
            </td>
            <td>
              <button class="permission-checkbox inner checked default" id="diagnosis-inner"></button>
            </td>
            <td>
              <button class="permission-checkbox outer" id="diagnosis-outer"></button>
            </td>
            <td>
              <button class="permission-checkbox extended" id="diagnosis-extended"></button>
            </td>
          </tr>

          <tr>
            <td>
              <div class="row-icon-block">
                <img src="/assets/img/symptoms.png" class="row-icon">
              </div>
              <div class="row-name-block">
                <p class="row-name">Symptoms</p>
              </div>
            </td>
            <td>
              <button class="permission-checkbox inner checked default" id="symptoms-inner"></button>
            </td>
            <td>
              <button class="permission-checkbox outer" id="symptoms-outer"></button>
            </td>
            <td>
              <button class="permission-checkbox extended" id="symptoms-extended"></button>
            </td>
          </tr>

          <tr>
            <td>
              <div class="row-icon-block">
                <img src="/assets/img/diet.png" class="row-icon">
              </div>
              <div class="row-name-block">
                <p class="row-name">Diet</p>
              </div>
            </td>
            <td>
              <button class="permission-checkbox inner checked default" id="diet-inner"></button>
            </td>
            <td>
              <button class="permission-checkbox outer checked default" id="diet-outer"></button>
            </td>
            <td>
              <button class="permission-checkbox extended" id="diet-extended"></button>
            </td>
          </tr>

          <tr>
            <td>
              <div class="row-icon-block">
                <img src="/assets/img/exercise.png" class="row-icon">
              </div>
              <div class="row-name-block">
                <p class="row-name">Exercise</p>
              </div>
            </td>
            <td>
              <button class="permission-checkbox inner checked default" id="exercise-inner"></button>
            </td>
            <td>
              <button class="permission-checkbox outer checked default" id="exercise-outer"></button>
            </td>
            <td>
              <button class="permission-checkbox extended" id="exercise-extended"></button>
            </td>
          </tr>

          <tr>
            <td>
              <div class="row-icon-block">
                <img src="/assets/img/appointment.png" class="row-icon">
              </div>
              <div class="row-name-block">
                <p class="row-name">Appointments</p>
              </div>
            </td>
            <td>
              <button class="permission-checkbox inner checked default" id="appointments-inner"></button>
            </td>
            <td>
              <button class="permission-checkbox outer checked default" id="appointments-outer"></button>
            </td>
            <td>
              <button class="permission-checkbox extended checked default" id="appointments-extended"></button>
            </td>
          </tr>

          <tr>
            <td>
              <div class="row-icon-block">
                <img src="/assets/img/transport.png" class="row-icon">
              </div>
              <div class="row-name-block">
                <p class="row-name">Transport</p>
              </div>
            </td>
            <td>
              <button class="permission-checkbox inner checked default" id="transport-inner"></button>
            </td>
            <td>
              <button class="permission-checkbox outer checked default" id="transport-outer"></button>
            </td>
            <td>
              <button class="permission-checkbox extended checked default" id="transport-extended"></button>
            </td>
          </tr>
        </table>
      </div>

      <div class="row pb100">
        <div class="col-xs-6">
          <button id="restore-default-permissions" type="button" class="site-btn2 fullwidth">
            Restore Default
          </button>
        </div>
        <div class="col-xs-6">
          <button id="confirm-permissions-button" type="button" class="site-btn fullwidth">
            Confirm Permissions
          </button>
        </div>
      </div>
    </div>

  </body>
  <script>
    window.onload = function () {
      let mvp = document.getElementById('myViewport');
      if (window.innerWidth < 450) {
        mvp.setAttribute('content','width=450');
      }
    }
  </script>
  <script src="assets/js/jquery-2.1.4.min.js"></script>
  <script src="assets/js/bootstrap.min.js"></script>
  <script src="assets/js/ripple.js"></script>
  <script src="assets/js/jquery.cookie.js"></script>
  <script>
    $(document).ready(function(){
      if (!!$.cookie('patientContext')) {
        var patient = JSON.parse($.cookie("patientContext"));
        if (patient == null) {
          console.log("no patient context");
        } else {
          console.log(JSON.stringify(patient));
          console.log(patient.phn);
          console.log(patient.email);
        }
      } else {
        console.log("no patient context");
      }

      $("#confirm-permissions-button").click(function(e){
        window.location.href = 'circles';
      });

      $("#restore-default-permissions").click(function(e){
        $(".checked").removeClass("checked");
        $(".default").addClass("checked");
      });

      $(".permission-checkbox").click(function(e){
        $(this).toggleClass("checked");
        patient.checks = getChecks();
        console.log(patient.checks);
        $.ajax({
          type: "POST",
          url: 'permissions',
          data: patient,
          success: function(result) {

          },
          error: function(result) {
            alert('error');
          }
        });

        //console.log(getChecks());
      });

      getChecks = function(){
        var checks = [];
        checks.medication = {
          "inner": $("#medication-inner").hasClass("checked"),
          "outer": $("#medication-outer").hasClass("checked"),
          "extended": $("#medication-extended").hasClass("checked")
        };
        checks.diagnosis = {
          "inner": $("#diagnosis-inner").hasClass("checked"),
          "outer": $("#diagnosis-outer").hasClass("checked"),
          "extended": $("#diagnosis-extended").hasClass("checked")
        };
        checks.symptoms = {
          "inner": $("#symptoms-inner").hasClass("checked"),
          "outer": $("#symptoms-outer").hasClass("checked"),
          "extended": $("#symptoms-extended").hasClass("checked")
        };
        checks.diet = {
          "inner": $("#diet-inner").hasClass("checked"),
          "outer": $("#diet-outer").hasClass("checked"),
          "extended": $("#diet-extended").hasClass("checked")
        };
        checks.exercise = {
          "inner": $("#exercise-inner").hasClass("checked"),
          "outer": $("#exercise-outer").hasClass("checked"),
          "extended": $("#exercise-extended").hasClass("checked")
        };
        checks.appointments = {
          "inner": $("#appointments-inner").hasClass("checked"),
          "outer": $("#appointments-outer").hasClass("checked"),
          "extended": $("#appointments-extended").hasClass("checked")
        };
        checks.transport = {
          "inner": $("#transport-inner").hasClass("checked"),
          "outer": $("#transport-outer").hasClass("checked"),
          "extended": $("#transport-extended").hasClass("checked")
        };
        return checks;
      }
    });
  </script>
</html>
